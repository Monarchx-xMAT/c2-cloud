$(document).ready(function () {
        $.ajax({
            url: "/api/list/files",
            dataType: "json",
            type: "GET",
            async: false,
            success: function (data) {
                var dataTable = $("#mTable").DataTable({
                    data: data,
                    columns: [
                        { data: "file_name", title: "File name" }
                    ],
                    order: [[0, "asc"]],
                });

            },
            error: function (xhr, status, error) {
                console.log(xhr);
                alert("Error: " + status + " - " + error);
            },
    });

    // Drag and drop 

    const dragDropArea = document.getElementById('dragDropArea');

    dragDropArea.addEventListener('dragenter', (e) => {
      e.preventDefault();
      dragDropArea.classList.add('active');
    });

    dragDropArea.addEventListener('dragover', (e) => {
      e.preventDefault();
    });

    dragDropArea.addEventListener('dragleave', () => {
      dragDropArea.classList.remove('active');
    });

    dragDropArea.addEventListener('drop', async (e) => {
        e.preventDefault();
        dragDropArea.classList.remove('active');
        const files = e.dataTransfer.files;
        
        if (files.length > 0) {
          const file = files[0]; 
      
          const formData = new FormData();
          formData.append('file', file);
      
          try {
            const response = await fetch('/api/file/upload', {
              method: 'POST',
              body: formData
            });
      
            if (response.ok) {
              console.log('File uploaded successfully');
              $("#createModal .modal-body").text('File uploaded successfully');
              $("#createModal").modal("show");
              $("#create_ok").off().on('click', function () {
                    $("#createModal").modal("hide");
              });
            } else {
              console.error('Error uploading file');
              $("#createModal .modal-body").text('Error uploading file');
              $("#createModal").modal("show");
              $("#create_ok").off().on('click', function () {
                    $("#createModal").modal("hide");
              });
            }
          } catch (error) {
            console.error('Error:', error);
            $("#createModal .modal-body").text('Error: ' + error);
            $("#createModal").modal("show");
            $("#create_ok").off().on('click', function () {
                  $("#createModal").modal("hide");
            });
          }
        }
      });


});
